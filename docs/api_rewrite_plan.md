# План переписывания мобильного приложения и API

Мы начинаем полный редизайн мобильного приложения, который должен дать ощущение нового продукта: современный интерфейс, быстрые реакции, полнота функционала сайта. Этот документ фиксирует базовый план и входные точки API, чтобы разработка шла прозрачно и параллельно между бэкендом и новым фронтом.

## Цели
- **Полное покрытие** мобильного клиента всеми возможностями сайта: каталог, подборки, рейтинги, клубы, марафоны, игры, подписки и оплаты.
- **Современный UX**: навигация по сценариям (домашний фид → детали книги → действия/игры → сообщества), мгновенная загрузка экранов за счёт предзагрузки данных и лёгких JSON-ответов.
- **Чёткое версионирование API** (`/api/v1/`), чтобы новые клиенты могли развиваться независимо от старых.
- **Единая авторизация**: сессии Django или токены (расширение в v1), прозрачные права доступа.

## Быстрый прогресс: первые эндпоинты
- `/api/v1/health/` — ливнес/статус сервиса для мобилки и мониторинга.
- `/api/v1/feature-map/` — карта доменов, чтобы фронт и QA видели прогресс подключений.

## Карта доменов v1
| Домен | Минимальный первый шаг | Следующие итерации |
|-------|------------------------|--------------------|
| Каталог книг | Список книг + детали (`GET /books/`, `GET /books/{id}/`) | Поиск, фильтры, рейтинги, рецензии, действия (читать/добавить на полку) |
| Сообщества | Ленты клубов/марафонов (`GET /reading-clubs/`, `GET /marathons/`) | Подписка/вступление, приглашения, уведомления |
| Игры/квиз | Базовый список доступных игр (`GET /games/`) | Запуск/сохранение прогресса, таблицы лидеров |
| Профиль | Профиль и подписка (`GET /profile/`, `GET /profile/subscription/`) | Настройки, достижения, награды |
| Оплаты | Создание платежей YooKassa | Вебхуки, статусы, автопродление |

## Архитектурные принципы
- **DRF** для быстрых сериализаторов и фильтров.
- **NamespaceVersioning** с `api.urls` под `api/v1/` — можно добавлять `v2` без риска для клиентов.
- **Строгий JSON**: только `JSONRenderer/JSONParser`, минимум лишних полей.
- **Понятные ответы**: статусы, пагинация, ссылки на связанные ресурсы.

## Следующие шаги
1. Подключить реальные модели к сериализаторам: книги, авторы, подборки.
2. Добавить авторизацию токенами (SimpleJWT или `TokenAuthentication`).
3. Расширить `feature-map` автоматической генерацией из роутов или схемы.
4. Подготовить Swagger/Redoc для QA и мобильной команды.