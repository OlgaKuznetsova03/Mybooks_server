{% extends "base.html" %}
{% load i18n %}

{% block title %}{% trans "Новая заявка блогера" %} · {{ block.super }}{% endblock %}

{% block extra_css %}
<style>
.blogger-request-form-theme {
  --br-accent: #d9a365;
  --br-accent-dark: #c48847;
  --br-soft: #fbe7b5;
  --br-soft-16: rgba(251, 231, 181, .16);
  --br-soft-32: rgba(251, 231, 181, .32);
}

.blogger-request-form-theme .page-title {
  display: inline-flex;
  align-items: center;
  gap: .5rem;
  padding: .4rem .75rem;
  border-radius: .75rem;
  background: var(--br-soft);
  border: 1px solid var(--br-soft-16);
  margin-bottom: .5rem;
}

.blogger-request-form-theme .card {
  border-color: var(--br-soft-16);
  box-shadow: 0 20px 40px rgba(0, 0, 0, .08);
}

.blogger-request-form-theme .card-body {
  background-image: radial-gradient(120% 120% at 100% 0%, var(--br-soft-16), transparent 60%);
}

.blogger-request-form-theme .form-label,
.blogger-request-form-theme .form-check-label {
  font-weight: 600;
}

.blogger-request-form-theme .form-control,
.blogger-request-form-theme .form-select {
  border-color: var(--br-soft-32);
}

.blogger-request-form-theme .form-control:focus,
.blogger-request-form-theme .form-select:focus {
  border-color: var(--br-accent);
  box-shadow: 0 0 0 .2rem rgba(217, 163, 101, .25);
}

.blogger-request-form-theme .btn-primary {
  background-color: var(--br-accent) !important;
  border-color: var(--br-accent) !important;
  color: #2a1a09 !important;
  font-weight: 600;
}

.blogger-request-form-theme .btn-primary:hover,
.blogger-request-form-theme .btn-primary:focus {
  background-color: var(--br-accent-dark) !important;
  border-color: var(--br-accent-dark) !important;
  color: #2a1a09 !important;
}

.blogger-request-form-theme .platform-form {
  background: rgba(255, 255, 255, .75);
  border: 1px solid var(--br-soft-16);
  border-radius: .75rem;
  padding: 1rem;
}

.blogger-request-form-theme .platform-form + .platform-form {
  margin-top: 1rem;
}

.blogger-request-form-theme .delete-checkbox {
  margin-top: 1.75rem;
}
</style>
{% endblock %}

{% block content %}
<div class="blogger-request-form-theme">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
      <h1 class="h3 page-title">
        <i class="bi bi-stars text-warning"></i>
        {% trans "Новая заявка блогера" %}
      </h1>
      <p class="text-muted mb-4">
        {% trans "Заполните информацию о себе и площадках, чтобы авторы могли предложить сотрудничество." %}
      </p>

      <form method="post" class="card">
        <div class="card-body">
          {% csrf_token %}
          {{ form.non_field_errors }}

          {% for field in form %}
            <div class="mb-3">
              {% if field.field.widget.input_type == "checkbox" %}
                <div class="form-check">
                  {{ field }}
                  <label class="form-check-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                </div>
              {% else %}
                <label class="form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field }}
              {% endif %}
              {% if field.help_text %}
                <div class="form-text">{{ field.help_text }}</div>
              {% endif %}
              {% for error in field.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>
          {% endfor %}

            <hr class="my-4">

          <h2 class="h5 mb-3">{% trans "Площадки и охват" %}</h2>
          <p class="text-muted small mb-3">
            {% trans "Расскажите, где вы публикуете отзывы, и укажите ориентировочное количество подписчиков." %}
          </p>

          {{ formset.management_form }}
          {{ formset.non_form_errors }}

    {% for platform_form in formset %}
            <div class="platform-form">
              {% for hidden in platform_form.hidden_fields %}
                {{ hidden }}
              {% endfor %}
              {{ platform_form.non_field_errors }}
              <div class="row g-3">
                {% for field in platform_form.visible_fields %}
                  {% if field.name == "DELETE" %}
                    <div class="col-md-2 delete-checkbox">
                      <div class="form-check">
                        {{ field }}
                        <label class="form-check-label" for="{{ field.id_for_label }}">{% trans "Удалить" %}</label>
                      </div>
                    </div>
                  {% else %}
                    {% if field.name == "followers_count" %}
                      <div class="col-md-4 col-lg-3">
                    {% else %}
                      <div class="col-md-6">
                    {% endif %}
                        <label class="form-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                        {{ field }}
                        {% if field.help_text %}
                          <div class="form-text">{{ field.help_text }}</div>
                        {% endif %}
                        {% for error in field.errors %}
                          <div class="invalid-feedback d-block">{{ error }}</div>
                        {% endfor %}
                      </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        </div>
      <div class="card-footer text-end">
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-check2-circle me-1"></i>{% trans "Опубликовать" %}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
