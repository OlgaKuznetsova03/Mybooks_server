{% extends "base.html" %}
{% load static %}
{% block title %}–ì–ª–∞–≤–Ω–∞—è ¬∑ –ö–∞–ª–µ–π–¥–æ—Å–∫–æ–ø –∫–Ω–∏–≥{% endblock %}

{% block body_class %} home-page{% endblock %}

{% block extra_css %}
{{ block.super }}
<style>
  /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }

  @keyframes glow {
    0%, 100% { box-shadow: 0 0 20px rgba(171, 120, 67, 0.3); }
    50% { box-shadow: 0 0 40px rgba(171, 120, 67, 0.6); }
  }

  @keyframes shimmer {
    0% { background-position: -1000px 0; }
    100% { background-position: 1000px 0; }
  }

  @keyframes bookFlip {
    0% { transform: perspective(1000px) rotateY(0deg); }
    50% { transform: perspective(1000px) rotateY(10deg); }
    100% { transform: perspective(1000px) rotateY(0deg); }
  }

  @keyframes counter {
    from { --num: 0; }
    to { --num: var(--target); }
  }

  .animate-fade-in { animation: fadeInUp 0.8s ease-out forwards; }
  .animate-float { animation: float 3s ease-in-out infinite; }
  .animate-pulse { animation: pulse 2s ease-in-out infinite; }
  .animate-glow { animation: glow 2s ease-in-out infinite; }
  .animate-book { animation: bookFlip 3s ease-in-out infinite; }

  body.home-page {
    background: linear-gradient(180deg, #d7bda6 0%, #f8f1ea 45%, #ffffff 100%);
    overflow-x: hidden;
  }

  /* Hero Section —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
  .hero-section {
    background: 
      radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.8) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(171, 120, 67, 0.1) 0%, transparent 50%),
      radial-gradient(circle at top right, rgba(255, 255, 255, 0.65), transparent 55%), 
      #d7bda6;
    border-radius: 2.5rem;
    padding: clamp(2.5rem, 6vw, 4rem);
    color: #2f1d0f;
    box-shadow: 0 2.75rem 4rem rgba(77, 54, 28, 0.15);
    position: relative;
    overflow: hidden;
    opacity: 0;
    animation: fadeInUp 1s ease-out 0.3s forwards;
  }

  .hero-section::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    animation: shimmer 3s ease-in-out infinite;
  }

  .hero-section::after {
    content: "";
    position: absolute;
    inset: 1.5rem;
    border-radius: 2rem;
    border: 1px solid rgba(255, 255, 255, 0.35);
    pointer-events: none;
  }

  /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ñ–∏—á */
  .hero-highlight {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }

  .reading-progress-cover {
    width: 64px;
    aspect-ratio: 2 / 3;
    border-radius: 0.75rem;
    overflow: hidden;
    background: #f3ece4;
    box-shadow:
      inset 0 0 0 1px rgba(171, 120, 67, 0.2),
      0 10px 20px rgba(77, 54, 28, 0.18);
    flex-shrink: 0;
  }

  .reading-progress-cover img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .hero-highlight__card {
    display: block;
    backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.75);
    border-radius: 1.25rem;
    padding: 1.2rem;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.55);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    opacity: 1;
    transform: translateY(0);
    color: inherit;
    text-decoration: none;
    white-space: normal !important;
    word-break: break-word;
    overflow-wrap: anywhere;
    text-wrap: pretty;
    hyphens: auto;
  }

  .hero-highlight__card p {
    line-height: 1.55;
    white-space: normal !important;
  }
  .hero-highlight__card:focus-visible {
    outline: 2px solid rgba(171, 120, 67, 0.65);
    outline-offset: 4px;
  }

  .hero-highlight__card.animate-in {
    opacity: 0;
    transform: translateY(24px);
    animation: fadeInUp 0.6s ease-out var(--card-delay, 0s) forwards;
  }

  .tracker-updates-row {
    display: flex;
    flex-wrap: nowrap;
    gap: 1rem;
    overflow-x: auto;
    padding-bottom: 0.4rem;
    scroll-snap-type: x proximity;
    direction: rtl;
  }

  .tracker-updates-row .hero-highlight__card {
    flex: 0 0 min(280px, calc(100vw - 3rem));
    min-height: 100%;
    scroll-snap-align: start;
    direction: ltr;
  }

  .tracker-updates-row::-webkit-scrollbar {
    height: 0.5rem;
  }

  .tracker-updates-row::-webkit-scrollbar-thumb {
    background: rgba(171, 120, 67, 0.45);
    border-radius: 999px;
  }

  .hero-highlight__card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(171, 120, 67, 0.1), transparent);
    transition: left 0.6s ease;
  }

  .hero-highlight__card:hover::before {
    left: 100%;
  }

  .hero-highlight__card:hover {
    transform: translateY(-10px) scale(1.02);
    background: rgba(255, 255, 255, 0.9);
    box-shadow: 
      inset 0 0 0 1px rgba(171, 120, 67, 0.3),
      0 20px 40px rgba(77, 54, 28, 0.2);
  }

  .hero-highlight__card i {
    transition: transform 0.3s ease, color 0.3s ease;
  }

  .hero-highlight__card:hover i {
    transform: scale(1.2);
    color: #8b5a2b !important;
  }

  .feature-visual-grid {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    margin-top: 1.5rem;
  }

  .feature-visual-card {
    height: 100%;
    display: flex;
    flex-direction: column;
    background: rgba(255, 255, 255, 0.85);
    border-radius: 1.5rem;
    box-shadow:
      inset 0 0 0 1px rgba(171, 120, 67, 0.2),
      0 1.5rem 3rem rgba(77, 54, 28, 0.12);
    overflow: hidden;
    position: relative;
    transition: transform 0.4s ease, box-shadow 0.4s ease;
  }

  .feature-visual-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(171, 120, 67, 0.08), transparent 55%);
    opacity: 0;
    transition: opacity 0.4s ease;
    pointer-events: none;
  }

  .feature-visual-card:hover {
    transform: translateY(-8px);
    box-shadow:
      inset 0 0 0 1px rgba(171, 120, 67, 0.35),
      0 2rem 4rem rgba(77, 54, 28, 0.2);
  }

  .feature-visual-card:hover::before {
    opacity: 1;
  }

  .feature-visual-card__image {
    position: relative;
    overflow: hidden;
  }

  .feature-visual-card__image img {
    width: 100%;
    display: block;
    object-fit: cover;
    transition: transform 0.6s ease;
  }

  .feature-visual-card:hover .feature-visual-card__image img {
    transform: scale(1.05);
  }

  .feature-visual-card__body {
    padding: 1.75rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .feature-visual-card__title {
    font-weight: 700;
    letter-spacing: -0.01em;
  }

  .feature-visual-card__list {
    margin: 0;
    padding-left: 1.2rem;
    color: #4f3a28;
  }

  .feature-visual-card__list li + li {
    margin-top: 0.4rem;
  }

  .home-section {
    margin-top: clamp(3rem, 6vw, 4.5rem);
    opacity: 0;
    animation: fadeInUp 0.8s ease-out forwards;
  }

  .home-section:nth-child(2) { animation-delay: 0.4s; }
  .home-section:nth-child(3) { animation-delay: 0.6s; }

  .section-heading {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .section-heading__title {
    margin: 0;
    font-weight: 700;
    letter-spacing: -0.02em;
    position: relative;
    display: inline-block;
  }

  .section-heading__title::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 0;
    height: 3px;
    background: linear-gradient(90deg, #ab7843, #d7bda6);
    transition: width 0.6s ease;
  }

  .section-heading:hover .section-heading__title::after {
    width: 100%;
  }

  /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ –≤ –ø–æ–¥–±–æ—Ä–∫–∞—Ö */
  .books-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
  }

  .book-card {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 1rem;
    padding: 1.5rem 1rem;
    text-align: center;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(171, 120, 67, 0.2);
  }

  .book-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(171, 120, 67, 0.1), transparent);
    transition: left 0.6s ease;
  }

  .book-card:hover::before {
    left: 100%;
  }

  .book-card:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 20px 40px rgba(77, 54, 28, 0.2);
    border-color: rgba(171, 120, 67, 0.4);
  }

  .book-cover {
    width: 80px;
    height: 120px;
    background: linear-gradient(135deg, #ab7843, #d7bda6);
    border-radius: 8px;
    margin: 0 auto 1rem;
    position: relative;
    transition: all 0.4s ease;
    animation: bookFlip 4s ease-in-out infinite;
  }

  .book-card:hover .book-cover {
    animation: none;
    transform: perspective(1000px) rotateY(15deg) scale(1.1);
  }

  .book-cover::after {
    content: 'üìñ';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
  }

  .book-title {
    font-weight: 600;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
    line-height: 1.3;
  }

  .book-author {
    color: #666;
    font-size: 0.8rem;
  }

  .featured-shelf {
    position: relative;
    padding: clamp(1.75rem, 5vw, 2.5rem);
    border-radius: 1.75rem;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.7));
    box-shadow: inset 0 0 0 1px rgba(171, 120, 67, 0.25), 0 1.5rem 3rem rgba(75, 54, 33, 0.15);
    overflow: hidden;
  }

  .featured-shelf::before {
    content: "";
    position: absolute;
    inset: 1.25rem;
    border-radius: 1.5rem;
    border: 1px dashed rgba(171, 120, 67, 0.35);
    pointer-events: none;
  }

  .featured-book {
    background: rgba(215, 189, 166, 0.35);
    border-radius: 1.25rem;
    padding: 1.25rem;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 1rem 2rem rgba(43, 29, 19, 0.08);
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }

  .featured-book::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.6s ease;
  }

  .featured-book:hover::before {
    left: 100%;
  }

  .featured-book:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 2rem 4rem rgba(43, 29, 19, 0.2);
    background: rgba(215, 189, 166, 0.5);
  }

  /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—á–µ—Ç—á–∏–∫–∏ */
  .counter {
    font-variant-numeric: tabular-nums;
    animation: counter 2s ease-out forwards;
    counter-reset: num var(--num);
  }

  .counter::before {
    content: counter(num);
  }

  .timeline-card {
    border-radius: 1.5rem;
    padding: 1.75rem;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(171, 120, 67, 0.15);
    height: 100%;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    transition: all 0.3s ease;
  }

  .timeline-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 30px rgba(77, 54, 28, 0.1);
  }

  .timeline-item {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 0.85rem 1rem;
    align-items: center;
    transition: all 0.3s ease;
  }

  .timeline-item:hover {
    transform: translateX(10px);
  }

  .timeline-item__time {
    font-weight: 700;
    color: #ab7843;
    transition: color 0.3s ease;
  }

  .timeline-item:hover .timeline-item__time {
    color: #8b5a2b;
  }

  /* CTA Banner —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π */
  .cta-banner {
    background: 
      linear-gradient(90deg, rgba(171, 120, 67, 0.95), rgba(122, 74, 36, 0.95)),
      url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="books" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><text x="0" y="15" font-family="Arial" font-size="12" fill="rgba(255,255,255,0.1)">üìö</text></pattern></defs><rect width="100" height="100" fill="url(%23books)"/></svg>');
    color: #fff;
    border-radius: 2rem;
    padding: clamp(2rem, 4vw, 3rem);
    box-shadow: 0 2rem 3.5rem rgba(58, 35, 16, 0.25);
    position: relative;
    overflow: hidden;
    opacity: 0;
    animation: fadeInUp 0.8s ease-out 0.8s forwards;
  }

  .cta-banner::before {
    content: "";
    position: absolute;
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
    border-radius: 50%;
    top: -200px;
    right: -150px;
    animation: float 6s ease-in-out infinite;
  }

  .cta-banner::after {
    content: "";
    position: absolute;
    width: 280px;
    height: 280px;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 50%;
    top: -120px;
    right: -100px;
    animation: float 4s ease-in-out infinite reverse;
  }

  .cta-banner .btn {
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .cta-banner .btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
  }

  .cta-banner .btn:hover::before {
    left: 100%;
  }

  .cta-banner .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
  }

  /* –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ü–∏—Ñ—Ä—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
  .stat-number {
    font-size: 3rem;
    font-weight: 800;
    background: linear-gradient(135deg, #fff, #f8f1ea);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    position: relative;
    display: inline-block;
  }

  .stat-number::after {
    content: '';
    position: absolute;
    bottom: -5px;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, transparent, #fff, transparent);
    transform: scaleX(0);
    transition: transform 0.6s ease;
  }

  .stat-item:hover .stat-number::after {
    transform: scaleX(1);
  }

  /* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ */
  .btn-magic {
    background: linear-gradient(135deg, #ab7843, #d7bda6);
    border: none;
    color: white;
    position: relative;
    overflow: hidden;
    transition: all 0.4s ease;
  }

  .btn-magic:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(171, 120, 67, 0.4);
  }

  /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ */
  .scroll-reveal {
    opacity: 0;
    transform: translateY(50px);
    transition: all 0.8s ease;
  }

  .scroll-reveal.revealed {
    opacity: 1;
    transform: translateY(0);
  }

  .community-strip {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: minmax(260px, 1fr);
    gap: 1rem;
    overflow-x: auto;
    padding: 0.5rem 0 0.75rem;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
  }

  .community-strip::-webkit-scrollbar {
    height: 8px;
  }

  .community-strip::-webkit-scrollbar-thumb {
    background: rgba(171, 120, 67, 0.35);
    border-radius: 999px;
  }

  .community-card {
    display: flex;
    gap: 1rem;
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(171, 120, 67, 0.25);
    border-radius: 1rem;
    padding: 1rem;
    box-shadow: 0 12px 28px rgba(77, 54, 28, 0.12);
    scroll-snap-align: start;
    min-height: 100%;
    transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
  }

  .community-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 16px 32px rgba(77, 54, 28, 0.18);
    border-color: rgba(171, 120, 67, 0.45);
  }

  .community-card__cover {
    width: 60px; /* –µ—â–µ –º–µ–Ω—å—à–µ */
    height: 90px; /* –ø—Ä–æ–ø–æ—Ä—Ü–∏—è 2:3 */
    flex-shrink: 0;
    border-radius: 0.4rem;
    overflow: hidden;
    background: linear-gradient(135deg, #f8f1ea, #e8ddd0);
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid rgba(171, 120, 67, 0.2);
  }

  .community-card__cover img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 3px;
  }

  .community-card__cover-placeholder {
    font-size: 1.2rem;
    color: rgba(77, 54, 28, 0.4);
  }

  .community-card__title a {
    color: #2f1d0f;
    text-decoration: none;
  }

  .community-card__title a:hover {
    text-decoration: underline;
  }

  .community-card__meta {
    color: #6f5843;
  }

  @media (min-width: 992px) {
    .community-strip {
      grid-auto-flow: row;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      overflow: visible;
    }
  }

  @media (max-width: 991.98px) {
    .hero-section {
      border-radius: 2rem;
    }

    .hero-section::after {
      inset: 1rem;
      border-radius: 1.6rem;
    }

    .section-heading {
      align-items: flex-start;
    }

    .books-grid {
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 1rem;
    }
  }

  @media (max-width: 575.98px) {
    main.container {
      padding-left: 1rem !important;
      padding-right: 1rem !important;
    }

    .hero-section {
      padding: 2.25rem 1.75rem;
    }

    .hero-highlight {
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    .featured-shelf {
      padding: 1.5rem;
    }

    .stat-number {
      font-size: 2.5rem;
    }

    .feature-visual-card__body {
      padding: 1.5rem;
    }
  }

  @media (max-width: 480px) {
    .hero-section {
      padding: 2rem 1.35rem;
    }

    .hero-highlight {
      gap: 0.75rem;
    }

    .hero-highlight__card {
      min-width: 92%;
      padding: 1.1rem 1rem;
    }

    .hero-highlight__card h3 {
      font-size: 1rem;
    }

    .hero-highlight__card p {
      font-size: 0.95rem;
    }
  }
</style>
{% endblock %}

{% block content %}

<section class="hero-section mb-5">
  {% if user.is_authenticated %}
    {% if reading_items %}
      <div class="d-flex flex-column gap-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
          <div>
            <p class="text-muted mb-1">–ß–∏—Ç–∞—é —Å–µ–π—á–∞—Å</p>
            <h1 class="h3 mb-0">–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∫–Ω–∏–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ —É –≤–∞—Å –Ω–∞ –ø–æ–ª–∫–µ</h1>
          </div>
          <a class="btn btn-outline-dark btn-magic" href="{% url 'shelves:reading_now' %}">
            <i class="bi bi-journal-text me-2"></i>–í—Å–µ –∫–Ω–∏–≥–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
          </a>
        </div>

        <div class="hero-highlight">
          {% for it in reading_items %}
            <article class="hero-highlight__card animate-in h-100 d-flex flex-column" style="--card-delay: {{ forloop.counter0|add:1 }}00ms;">
              <div class="d-flex align-items-center gap-3 mb-3">
                <div class="reading-progress-cover">
                  {% with cover_url=it.book.get_cover_url %}
                    {% if cover_url %}
                      <img src="{{ cover_url }}" alt="–û–±–ª–æ–∂–∫–∞ {{ it.book.title }}" loading="lazy" />
                    {% else %}
                      <img src="{% static 'books/cover-placeholder-2x3.png' %}" alt="–ù–µ—Ç –æ–±–ª–æ–∂–∫–∏" />
                    {% endif %}
                  {% endwith %}
                </div>

                <div class="flex-grow-1">
                  <h3 class="h6 fw-semibold mb-0">{{ it.book.title }}</h3>
                  {% with authors=it.book.authors.all %}
                    {% if authors %}<div class="small text-muted">{{ authors|join:", " }}</div>{% endif %}
                  {% endwith %}
                </div>
              </div>

              <div class="d-flex align-items-center gap-3 mb-3 flex-grow-1">
                <div class="flex-grow-1">
                  {% if it.progress %}
                    <div class="progress" style="height: 10px;">
                      <div
                        class="progress-bar bg-primary"
                        style="width: {{ it.progress_percent|floatformat:'0' }}%"
                        role="progressbar"
                        aria-valuenow="{{ it.progress_percent|floatformat:'0' }}"
                        aria-valuemin="0"
                        aria-valuemax="100"
                      ></div>
                    </div>
                    <div class="small text-muted d-flex justify-content-between mt-2">
                      <span>{{ it.progress_percent|floatformat:"0" }}%</span>
                      {% if it.progress_current_page %}
                        <span>{{ it.progress_current_page }} —Å—Ç—Ä.</span>
                      {% elif it.progress_total_pages %}
                        <span>{{ it.progress_total_pages }} —Å—Ç—Ä.</span>
                      {% endif %}
                    </div>
                  {% else %}
                    <p class="small text-muted mb-0">–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å, —á—Ç–æ–±—ã —Ç—Ä–µ–∫–µ—Ä –ø–æ–¥—Å—Ç—Ä–æ–∏–ª—Å—è –ø–æ–¥ –≤–∞—Å.</p>
                  {% endif %}
                </div>
              </div>

              <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –∫–Ω–æ–ø–æ–∫ -->
              <div class="d-flex flex-wrap gap-2 mt-auto pt-2" style="min-height: 40px;">
                <a class="btn btn-dark btn-sm" href="{% url 'shelves:reading_track' it.book.id %}">
                  <i class="bi bi-graph-up-arrow me-1"></i>–ö —Ç—Ä–µ–∫–µ—Ä—É
                </a>
                <a class="btn btn-outline-dark btn-sm" href="{% url 'book_detail' it.book.id %}">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
              </div>
            </article>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <div class="text-center">
        <p class="text-muted mb-2">–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–Ω–∏–≥</p>
        <h2 class="h4 mb-3">–î–æ–±–∞–≤—å—Ç–µ –∫–Ω–∏–≥–∏ –Ω–∞ –ø–æ–ª–∫—É ¬´–ß–∏—Ç–∞—é¬ª, —á—Ç–æ–±—ã —Ç—Ä–µ–∫–µ—Ä –±—ã–ª –ø–æ–¥ —Ä—É–∫–æ–π</h2>
        <div class="d-flex justify-content-center gap-2 flex-wrap">
          <a class="btn btn-dark btn-magic" href="{% url 'shelves:reading_now' %}"><i class="bi bi-plus-circle me-2"></i>–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥–∏</a>
          <a class="btn btn-outline-dark btn-magic" href="{% url 'shelves:home_library' %}">–ü–µ—Ä–µ–π—Ç–∏ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É</a>
        </div>
      </div>
    {% endif %}
    
    {% if latest_tracker_updates %}
      <div class="mt-4">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-3">
          <div>
            <p class="text-muted mb-1">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ç—Ä–µ–∫–µ—Ä–µ</p>
            <h2 class="h4 mb-0">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–∏–ª–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
          </div>
        </div>

        <div class="hero-highlight tracker-updates-row">
          {% for update in latest_tracker_updates %}
            {% with display_name=update.user.get_full_name|default:update.user.username cover_url=update.book.get_cover_url %}
              <article class="hero-highlight__card animate-in h-100 d-flex flex-column" style="--card-delay: {{ forloop.counter0|add:1 }}00ms;">
                <div class="d-flex align-items-center gap-2 mb-3">
                  <a href="{% url 'profile' update.user.username %}" class="text-decoration-none d-flex align-items-center gap-2">
                    {% if update.user.profile.avatar %}
                      <img src="{{ update.user.profile.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä {{ display_name }}" class="rounded-circle" width="42" height="42" style="object-fit: cover;">
                    {% else %}
                      <span class="rounded-circle d-inline-flex align-items-center justify-content-center text-white" style="width: 42px; height: 42px; background: #c08d57; font-size: 0.8rem;">{{ update.user.username|slice:":1"|upper }}</span>
                    {% endif %}
                    <span class="fw-semibold text-dark">{{ update.user.username }}</span>
                  </a>
                </div>

                <div class="d-flex align-items-center gap-3 mb-3">
                  <a href="{% url 'book_detail' update.book.id %}" class="reading-progress-cover">
                    {% if cover_url %}
                      <img src="{{ cover_url }}" alt="–û–±–ª–æ–∂–∫–∞ {{ update.book.title }}" loading="lazy" />
                    {% else %}
                      <img src="{% static 'books/cover-placeholder-2x3.png' %}" alt="–ù–µ—Ç –æ–±–ª–æ–∂–∫–∏" />
                    {% endif %}
                  </a>
                  <div class="flex-grow-1">
                    <a href="{% url 'book_detail' update.book.id %}" class="text-decoration-none text-dark">
                      <h3 class="h6 fw-semibold mb-1">{{ update.book.title }}</h3>
                    </a>
                    <div class="small text-muted">{{ update.updated_at|date:"d.m.Y H:i" }}</div>
                  </div>
                </div>

                <div class="mt-auto">
                  <div class="progress" style="height: 10px;">
                    <div
                      class="progress-bar bg-primary"
                      style="width: {{ update.percent|floatformat:'0' }}%"
                      role="progressbar"
                      aria-valuenow="{{ update.percent|floatformat:'0' }}"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    ></div>
                  </div>
                  <div class="small text-muted d-flex justify-content-between mt-2">
                    <span>–î–æ–±–∞–≤–∏–ª(–∞): {{ update.percent|floatformat:"0" }}%</span>
                    {% if update.current_page %}
                      <span>{{ update.current_page }} —Å—Ç—Ä.</span>
                    {% endif %}
                  </div>
                </div>
              </article>
            {% endwith %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
  {% else %}
    <div
      class="hero-highlight"
      style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;"
    >
      <a
        class="hero-highlight__card h-100"
        href="{% url 'shelves:home_library' %}"
        data-feature-title="–î–æ–º–∞—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞"
        data-feature-message="–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é –∫–Ω–∏–≥! üìö"
      >
        <div class="d-flex align-items-center gap-2 mb-3">
          <i class="bi bi-house-heart fs-4 animate-pulse" style="color:#ab7843"></i>
          <h3 class="h5 fw-semibold mb-0">–î–æ–º–∞—à–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞</h3>
        </div>
        <p class="mb-0">–í—Å–µ–≥–¥–∞ –∑–Ω–∞–π—Ç–µ, —Å–∫–æ–ª—å–∫–æ –∫–Ω–∏–≥ —Å—Ç–æ–∏—Ç –Ω–∞ –≤–∞—à–∏—Ö –ø–æ–ª–∫–∞—Ö, –∫–∞–∫–∏–µ –µ—â—ë –æ–∂–∏–¥–∞—é—Ç –ø—Ä–æ—á—Ç–µ–Ω–∏—è –∏ —á—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ —á–∞—â–µ ‚Äî —á–∏—Ç–∞–µ—Ç–µ –∏–ª–∏ –ø–æ–ø–æ–ª–Ω—è–µ—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é.</p>
      </a>
      <a
        class="hero-highlight__card h-100"
        href="{% url 'games:index' %}"
        data-feature-title="–ò–≥—Ä—ã"
        data-feature-message="–°–¥–µ–ª–∞–π—Ç–µ —á—Ç–µ–Ω–∏–µ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π –∏–≥—Ä–æ–π! üéÆ"
      >
        <div class="d-flex align-items-center gap-2 mb-3">
          <i class="bi bi-controller fs-4 animate-pulse" style="color:#ab7843"></i>
          <h3 class="h5 fw-semibold mb-0">–ò–≥—Ä—ã</h3>
        </div>
        <p class="mb-0">–ë—Ä–æ—Å—å—Ç–µ —Å–µ–±–µ –≤—ã–∑–æ–≤, –ø–æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å –Ω–æ–≤—ã–º–∏ –∞–≤—Ç–æ—Ä–∞–º–∏ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ—Å—å –≤ –∫–Ω–∏–∂–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ —Å –Ω–∞—à–∏–º–∏ –∏–≥—Ä–æ–≤—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏.</p>
      </a>
      <a
        class="hero-highlight__card h-100"
        href="{% url 'collaborations:offer_list' %}"
        data-feature-title="–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ"
        data-feature-message="–°—Ç–∞–Ω—å—Ç–µ —á–∞—Å—Ç—å—é –∫–Ω–∏–∂–Ω–æ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞! ü§ù"
      >
        <div class="d-flex align-items-center gap-2 mb-3">
          <i class="bi bi-heart-fill fs-4 animate-pulse" style="color:#ab7843"></i>
          <h3 class="h5 fw-semibold mb-0">–°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ</h3>
        </div>
        <p class="mb-0">–ê–≤—Ç–æ—Ä—ã –∏—â—É—Ç —á–∏—Ç–∞—Ç–µ–ª–µ–π –∏ –±–ª–æ–≥–µ—Ä–æ–≤: –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –∏ –ø–æ–ª—É—á–∏—Ç–µ –∫–Ω–∏–≥—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏.</p>
      </a>
    </div>
  {% endif %}
</section>

<section class="home-section scroll-reveal">
  <div class="section-heading">
    <h2 class="section-heading__title h3">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã–µ —á—Ç–µ–Ω–∏—è</h2>
    <a class="btn btn-outline-dark btn-sm btn-magic" href="{% url 'reading_clubs:list' %}">
      <i class="bi bi-people me-1"></i>–í—Å–µ —á—Ç–µ–Ω–∏—è
    </a>
  </div>

  {% if active_clubs %}
    <div class="community-strip" role="list">
      {% for club in active_clubs %}
        <article class="community-card h-100" role="listitem">
          <div class="community-card__cover" aria-hidden="true">
            {% with cover_url=club.book.get_cover_url %}
              {% if cover_url %}
                <img src="{{ cover_url }}" alt="–û–±–ª–æ–∂–∫–∞ –∫–Ω–∏–≥–∏ {{ club.book.title }}" loading="lazy" style="object-fit: contain; background: #f8f1ea;" />
              {% else %}
                <div class="community-card__cover-placeholder">üìö</div>
              {% endif %}
            {% endwith %}
          </div>
          <div class="flex-grow-1 d-flex flex-column gap-2">
            <div class="d-flex align-items-center gap-2 flex-wrap">
              <span class="badge text-bg-light"><i class="bi bi-broadcast-pin me-1"></i>–ò–¥—ë—Ç</span>
              <span class="small text-muted">
                –°—Ç–∞—Ä—Ç–æ–≤–∞–ª–æ {{ club.start_date|date:"d E" }}{% if club.end_date %} ¬∑ –¥–æ {{ club.end_date|date:"d E" }}{% endif %}
              </span>
            </div>
            <div class="community-card__title h6 mb-0">
              <a href="{{ club.get_absolute_url }}">{{ club.title }}</a>
            </div>
            <div class="text-muted small">
              <i class="bi bi-book me-1"></i>{{ club.book.title }}
            </div>
            <div class="community-card__meta small d-flex flex-wrap gap-3 mt-auto">
              <span><i class="bi bi-people me-1"></i>{{ club.approved_participant_count }} —É—á–∞—Å—Ç–Ω.</span>
              <span><i class="bi bi-chat-dots me-1"></i>{{ club.message_count }} —Å–æ–æ–±—â–µ–Ω–∏–π</span>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted mb-0">–°–µ–π—á–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö —á—Ç–µ–Ω–∏–π, –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—ë!</p>
  {% endif %}
</section>

<section class="home-section scroll-reveal">
  <div class="section-heading">
    <h2 class="section-heading__title h3">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—Ä–∞—Ñ–æ–Ω—ã</h2>
    <a class="btn btn-outline-dark btn-sm btn-magic" href="{% url 'reading_marathons:list' %}">
      <i class="bi bi-flag me-1"></i>–í—Å–µ –º–∞—Ä–∞—Ñ–æ–Ω—ã
    </a>
  </div>

  {% if active_marathons %}
    <div class="community-strip" role="list">
      {% for marathon in active_marathons %}
        <article class="community-card h-100" role="listitem">
          <div class="community-card__cover" aria-hidden="true">
            {% if marathon.cover %}
              <img src="{{ marathon.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞ –º–∞—Ä–∞—Ñ–æ–Ω–∞ {{ marathon.title }}" loading="lazy" />
            {% else %}
              <div class="community-card__cover-placeholder">üèÅ</div>
            {% endif %}
          </div>
          <div class="flex-grow-1 d-flex flex-column gap-2">
            <div class="d-flex align-items-center gap-2 flex-wrap">
              <span class="badge text-bg-light"><i class="bi bi-lightning-charge me-1"></i>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</span>
              <span class="small text-muted">
                –°—Ç–∞—Ä—Ç {{ marathon.start_date|date:"d E" }}{% if marathon.end_date %} ¬∑ —Ñ–∏–Ω–∏—à {{ marathon.end_date|date:"d E" }}{% endif %}
              </span>
            </div>
            <div class="community-card__title h6 mb-0">
              <a href="{{ marathon.get_absolute_url }}">{{ marathon.title }}</a>
            </div>
            <div class="text-muted small">
              <i class="bi bi-layers me-1"></i>{{ marathon.theme_count }} —Ç–µ–º
            </div>
            <div class="community-card__meta small d-flex flex-wrap gap-3 mt-auto">
              <span><i class="bi bi-people me-1"></i>{{ marathon.participant_count }} —É—á–∞—Å—Ç–Ω.</span>
              <span><i class="bi bi-clock-history me-1"></i>–ò–¥—ë—Ç —Å–µ–π—á–∞—Å</span>
            </div>
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <p class="text-muted mb-0">–ü–æ–∫–∞ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–æ–≤—ã–π –∏ –ø–æ–∑–æ–≤–∏—Ç–µ –¥—Ä—É–∑–µ–π.</p>
  {% endif %}
</section>

<section class="home-section scroll-reveal">
  <div class="section-heading">
    <h2 class="section-heading__title h3">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –¥–∏–Ω–∞–º–∏–∫–∞ —á—Ç–µ–Ω–∏—è</h2>
  </div>

  <div class="feature-visual-grid">
    <div class="feature-visual-card">
      <div class="feature-visual-card__image">
        <img
          src="{% static 'img/Statistic.png' %}"
          alt="–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á—Ç–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—å"
          loading="lazy"
        />
      </div>
      <div class="feature-visual-card__body">
        <h3 class="feature-visual-card__title h4 mb-0">–ì–ª—É–±–æ–∫–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è</h3>
        <p class="mb-0">
          –°–µ—Ä–≤–∏—Å —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É –¥–Ω—é, —á—Ç–æ–±—ã –≤—ã –≤–∏–¥–µ–ª–∏, –∫–æ–≥–¥–∞ —á–∏—Ç–∞–µ—Ç–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ, –∫–∞–∫–∏–µ –∫–Ω–∏–≥–∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç –∏
          –≤ –∫–∞–∫–∏–µ —á–∞—Å—ã —É–¥–æ–±–Ω–µ–µ –ø–æ–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏.
        </p>
        <ul class="feature-visual-card__list">
          <li>–ü–æ–¥—Ä–æ–±–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∞–º —á—Ç–µ–Ω–∏—è.</li>
          <li>–ü–æ–¥—Å–∫–∞–∑–∫–∏, –∫–æ–≥–¥–∞ –≤—ã –Ω–∞ –ø–∏–∫–µ —á–∏—Ç–∞—Ç–µ–ª—å—Å–∫–æ–π –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.</li>
          <li>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∫–ª—É–±–∞–º–∏ –∏ –º–∞—Ä–∞—Ñ–æ–Ω–∞–º–∏ –¥–ª—è –æ–±—â–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.</li>
        </ul>
      </div>
    </div>

    <div class="feature-visual-card">
      <div class="feature-visual-card__image">
        <img
          src="{% static 'img/Progress.png' %}"
          alt="–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö —á—Ç–µ–Ω–∏—è"
          loading="lazy"
        />
      </div>
      <div class="feature-visual-card__body">
        <h3 class="feature-visual-card__title h4 mb-0">–ì–∏–±–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</h3>
        <p class="mb-0">
          –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ –≤ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö, –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, —á–∞—Å–∞—Ö –∞—É–¥–∏–æ –∏–ª–∏ –≤ –º–∏–Ω—É—Ç–∞—Ö ‚Äî –º—ã —Å—Ä–∞–≤–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç—ã –∏ –ø–æ–¥—Å–∫–∞–∂–µ–º, –≥–¥–µ
          –∏—Å—Ç–æ—Ä–∏—è —É–≤–ª–µ–∫–∞–µ—Ç —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ.
        </p>
        <ul class="feature-visual-card__list">
          <li>–§–∏–∫—Å–∏—Ä—É–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</li>
          <li>–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ, –≤ –∫–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –∫–Ω–∏–≥–∞ –ø—Ä–æ–¥–≤–∏–≥–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ.</li>
          <li>–õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ—Å—å –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö.</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="home-section scroll-reveal">
  <div class="section-heading">
    <h2 class="section-heading__title h3">–ü–æ–¥–±–æ—Ä–∫–∏ –∏ –ø–æ–ª–∫–∏ –Ω–µ–¥–µ–ª–∏</h2>
    <a class="btn btn-outline-dark btn-sm btn-magic" href="{% url 'shelves:my_shelves' %}">
      <i class="bi bi-archive me-1"></i>–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ –ø–æ–ª–∫–∏
    </a>
  </div>

<section class="home-section scroll-reveal">
  <div class="cta-banner">
    <div class="row g-4 align-items-center">
      <div class="col-lg-7">
        <h2 class="h2 fw-bold mb-3 animate-glow">–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—É—é –≤—Å–µ–ª–µ–Ω–Ω—É—é —É–∂–µ —Å–µ–≥–æ–¥–Ω—è</h2>
        <p class="mb-4">–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª–∫–∏, –ø—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –∏–≥—Ä—ã, —á—Ç–æ–±—ã —á—Ç–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –æ–±—â–∏–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ–º. –ú—ã –ø–æ–∑–∞–±–æ—Ç–∏–º—Å—è –æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–∏.</p>
        <div class="d-flex flex-wrap gap-2">
          <a class="btn btn-light btn-lg text-dark btn-magic" href="{% url 'reading_marathons:list' %}">
            <i class="bi bi-flag me-2"></i>–ö–∞—Ç–∞–ª–æ–≥ –º–∞—Ä–∞—Ñ–æ–Ω–æ–≤
          </a>
          <a class="btn btn-outline-light btn-lg btn-magic" href="{% url 'collaborations:offer_list' %}">
            <i class="bi bi-megaphone me-2"></i>–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏–∏
          </a>
        </div>
      </div>
      <div class="col-lg-5">
        <div class="d-grid gap-3">
          <div class="d-flex align-items-center gap-3 stat-item">
            <div class="stat-number" style="--target: 5">5</div>
            <div>–∫–ª—É–±–æ–≤ –∞–∫—Ç–∏–≤–Ω–æ —á–∏—Ç–∞—é—Ç –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å</div>
          </div>
          <div class="d-flex align-items-center gap-3 stat-item">
            <div class="stat-number" style="--target: 96">96</div>
            <div>—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∫ –Ω–∞–º –∫–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é</div>
          </div>
          <div class="d-flex align-items-center gap-3 stat-item">
            <div class="stat-number" style="--target: 24">24</div>
            <div>–∂–∏–≤—ã–µ –±–µ—Å–µ–¥—ã, –º–∞—Ä–∞—Ñ–æ–Ω—ã –∏ –∏–≥—Ä—ã –Ω–∞ –ª—é–±–æ–π –≤–∫—É—Å</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
<div class="position-fixed top-0 end-0 p-3" style="z-index: 11">
  <div id="liveToast" class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body" id="toastMessage"></div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script>
  // –ê–Ω–∏–º–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
  function animateCounters() {
    const counters = document.querySelectorAll('.stat-number');
    counters.forEach(counter => {
      const target = parseInt(counter.style.getPropertyValue('--target'));
      let current = 0;
      const increment = target / 50;
      const timer = setInterval(() => {
        current += increment;
        if (current >= target) {
          counter.textContent = target + (counter.textContent.includes('%') ? '%' : '+');
          clearInterval(timer);
        } else {
          counter.textContent = Math.floor(current) + (counter.textContent.includes('%') ? '%' : '+');
        }
      }, 40);
    });
  }

   // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
    const animationEvent = triggerEvent ?? window.event ?? null;
    if (animationEvent && animationEvent.currentTarget) {
      const target = animationEvent.currentTarget;
      target.style.transform = 'scale(0.95)';
      setTimeout(() => {
        target.style.transform = '';
      }, 300);
    }
  }

  // –ü—Ä–µ–≤—å—é –∫–Ω–∏–≥–∏
  function showBookPreview(title, author) {
    showFeatureMessage(title, `–ê–≤—Ç–æ—Ä: ${author}. –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π! üìñ`, event);
  }

  // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
  function checkScroll() {
    const reveals = document.querySelectorAll('.scroll-reveal');
    reveals.forEach(element => {
      const windowHeight = window.innerHeight;
      const elementTop = element.getBoundingClientRect().top;
      const elementVisible = 150;
      
      if (elementTop < windowHeight - elementVisible) {
        element.classList.add('revealed');
      }
    });
  }

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  document.addEventListener('DOMContentLoaded', function() {
    // –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å—á–µ—Ç—á–∏–∫–æ–≤
    setTimeout(animateCounters, 1000);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–æ–ª–ª–∞
    window.addEventListener('scroll', checkScroll);
    checkScroll(); // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
    setTimeout(() => {
      showFeatureMessage('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!', '–ò—Å—Å–ª–µ–¥—É–π—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è —á—Ç–µ–Ω–∏—è! üåü');
    }, 2000);

    // –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π hover –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    const cards = document.querySelectorAll('.hero-highlight__card, .book-card, .featured-book, .feature-visual-card');
    cards.forEach(card => {
      card.addEventListener('mouseenter', function() {
        this.style.zIndex = '10';
      });

      card.addEventListener('mouseleave', function() {
        this.style.zIndex = '1';
      });
    });

    const featureCards = document.querySelectorAll('.hero-highlight__card[data-feature-title]');
    featureCards.forEach(card => {
      card.addEventListener('focus', event => {
        const title = card.getAttribute('data-feature-title');
        const message = card.getAttribute('data-feature-message');
        if (title && message) {
          showFeatureMessage(title, message, event);
        }
      });
    });
  });

  // –ü–∞—Ä–∞–ª–ª–∞–∫—Å —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –≥–µ—Ä–æ—è
  window.addEventListener('scroll', () => {
    const scrolled = window.pageYOffset;
    const hero = document.querySelector('.hero-section');
    if (hero) {
      hero.style.transform = `translateY(${scrolled * 0.5}px)`;
    }
  });

  // –ê–Ω–∏–º–∞—Ü–∏—è –≤–æ–ª–Ω—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  function createRipple(event) {
    const button = event.currentTarget;
    const circle = document.createElement("span");
    const diameter = Math.max(button.clientWidth, button.clientHeight);
    const radius = diameter / 2;

    circle.style.width = circle.style.height = `${diameter}px`;
    circle.style.left = `${event.clientX - button.offsetLeft - radius}px`;
    circle.style.top = `${event.clientY - button.offsetTop - radius}px`;
    circle.classList.add("ripple");

    const ripple = button.getElementsByClassName("ripple")[0];
    if (ripple) {
      ripple.remove();
    }

    button.appendChild(circle);
  }

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ripple —ç—Ñ—Ñ–µ–∫—Ç–∞ –∫ –∫–Ω–æ–ø–∫–∞–º
  const buttons = document.querySelectorAll('.btn-magic');
  buttons.forEach(button => {
    button.addEventListener('click', createRipple);
  });
</script>

<style>
  /* Ripple —ç—Ñ—Ñ–µ–∫—Ç */
  .ripple {
    position: absolute;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.7);
    transform: scale(0);
    animation: ripple 0.6s linear;
  }

  @keyframes ripple {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }

  .btn-magic {
    position: relative;
    overflow: hidden;
  }
</style>
{% endblock %}